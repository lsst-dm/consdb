"""Add guider columns to visit1_quicklook

Revision ID: 5f56db876c2b
Revises: 44666714690d
Create Date: 2025-11-21 19:47:11.575370+00:00

"""

from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql

# revision identifiers, used by Alembic.
revision: str = "5f56db876c2b"
down_revision: Union[str, None] = "44666714690d"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_exp_time",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Guider exposure time.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_roi_size",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Length of guider ROI side in pixels.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_n_tracked_stars",
            sa.INTEGER().with_variant(mysql.INTEGER(), "mysql").with_variant(sa.INTEGER(), "postgresql"),
            nullable=True,
            comment="Number of tracked stars.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_n_measurements",
            sa.INTEGER().with_variant(mysql.INTEGER(), "mysql").with_variant(sa.INTEGER(), "postgresql"),
            nullable=True,
            comment="Number of tracked star measurements.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_altitude_drift",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Altitude drift over exposure in arcsec.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_altitude_standard_deviation",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Standard deviation of altitude over exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_altitude_rms_detrended",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="RMS of altitude after trendline is subtracted.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_azimuth_drift",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Azimuth drift over exposure in arcsec.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_azimuth_standard_deviation",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Standard deviation of azimuth over exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_azimuth_rms_detrended",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="RMS of azimuth after trendline is subtracted.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_focalplane_theta_drift",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Focal plane theta drift over exposure in arcsec.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_focalplane_theta_standard_deviation",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Standard deviation of focal plane theta over exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_focalplane_theta_rms_detrended",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="RMS of focal plane theta after trendline is subtracted.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_magnitude_drift",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Magnitude drift over exposure in magnitudes.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_magnitude_standard_deviation",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Standard deviation of magnitude over exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_magnitude_rms_detrended",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="RMS of magnitude after trendline is subtracted.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_psf_fwhm_start",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="PSF FWHM of the guider star at the start of the exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_psf_fwhm_drift",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="PSF FWHM drift over exposure in arcsec.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_psf_fwhm_standard_deviation",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Standard deviation of PSF FWHM over exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_psf_fwhm_rms_detrended",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="RMS of PSF FWHM after trendline is subtracted.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_t_mean",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Mean second moment T for all measurements over the exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_e1_mean",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Mean second moment e1 for all measurements over the exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_e2_mean",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Mean second moment e2 for all measurements over the exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_ground_layer_seeing",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Ground layer seeing calculated with guider exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_mid_layer_seeing",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Mid layer seeing calculated with guider exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_free_seeing",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Free atmosphere seeing calculated with guider exposure.",
        ),
        schema="cdb_lsstcam",
    )
    op.add_column(
        "visit1_quicklook",
        sa.Column(
            "guider_total_seeing",
            sa.FLOAT().with_variant(mysql.FLOAT(), "mysql").with_variant(sa.FLOAT(), "postgresql"),
            nullable=True,
            comment="Total seeing calculated with guider exposure.",
        ),
        schema="cdb_lsstcam",
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column("visit1_quicklook", "guider_total_seeing", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_free_seeing", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_mid_layer_seeing", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_ground_layer_seeing", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_e2_mean", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_e1_mean", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_t_mean", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_psf_fwhm_rms_detrended", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_psf_fwhm_standard_deviation", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_psf_fwhm_drift", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_psf_fwhm_start", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_magnitude_rms_detrended", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_magnitude_standard_deviation", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_magnitude_drift", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_focalplane_theta_rms_detrended", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_focalplane_theta_standard_deviation", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_focalplane_theta_drift", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_azimuth_rms_detrended", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_azimuth_standard_deviation", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_azimuth_drift", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_altitude_rms_detrended", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_altitude_standard_deviation", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_altitude_drift", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_n_measurements", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_n_tracked_stars", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_roi_size", schema="cdb_lsstcam")
    op.drop_column("visit1_quicklook", "guider_exp_time", schema="cdb_lsstcam")
    # ### end Alembic commands ###
